---
title: "Social Capital and Crime <br>in Germany"
author: "Daniel Salgado Moreno and Lars Mehwald"
date: "4 December 2015"
output:
  slidy_presentation: default
  ioslides_presentation:
    logo: Supplementary/LogoHertie.png
---

## Outline
- Research Question
- Data
- Models
- Results

## Research Question
How do social networks and bonds in a given community determine the level of violent crime?

H0: *The more social capital in anygiven community, the less violent crime there would be observed.* 

H1: *The higher the foundations density is in a district, the lower the murder rate.* 

H2: *The lower the migration flow is in a district, the lower the murder rate.*  

H3: *The higher the voter turnout is in a district, the lower the murder rate.*

## Data

We gathered data from three main sources: 

1) German Federal Police's crime statistic ("Polizeiliche Kriminalstatistik" [PKS])  

2) The Regional Database Germany published by the Federal Statistical Office and the statistical Offices of the Lander  

3) German Federal Foundations Association ("Bundesverband Deutscher Stiftungen")  

## Data 

```{r SummaryStatistics, echo=FALSE, results='asis', warning=FALSE, message=FALSE}
# Setting the working directory
library("repmis")
library("stargazer")
possible_dir <- c('D:/Eigene Dokumente/!1 Vorlesungen/!! WS 2015/Introduction to Collaborative Social Science Data Analysis/Assignment3', 
                  '~/HSoG/DataAnalysis/GitHub/Assignment3')
set_valid_wd(possible_dir)
rm(possible_dir)
# Loading data set from csv file
DistrictData <- read.csv(file="Analysis/data/DistrictData2013.csv")
# Removing ranking column (it was added in the saving process in DataMerging.R)
DistrictData <- DistrictData[,-1]
# Removing some variables
DistrictDataReduced <- DistrictData[,c(55,57,47,54,53,40,22,50,51,52)]
# Rounding

# Renaming variables
names(DistrictDataReduced)[names(DistrictDataReduced) == 'UnemployedPercentage'] <- 'UnemployedPerc'
names(DistrictDataReduced)[names(DistrictDataReduced) == 'FoundationsDensity100k'] <- 'FoundationsDens'
names(DistrictDataReduced)[names(DistrictDataReduced) == 'TurnoutPercentage'] <- 'TurnoutPerc'
# Creation of summary statistics
stargazer(DistrictDataReduced,
          nobs = FALSE,
          header = FALSE,
          digits=1,
          type = "html")
```

## Data
```{r Top10Murder, echo=FALSE, results='asis',warning=FALSE, message=FALSE}
source("Analysis/Graphs.R")
top10MurderTab <- xtable(top10Murder, align = c("c","c","c","c"))
print(top10MurderTab,type="html")
#stargazer(top10Murder, header = FALSE, type="html")
```

## Data
```{r CorrChart, echo=FALSE, results='asis',warning=FALSE, message=FALSE}
source("Analysis/Graphs.R")
chart.Correlation(correlation.matrix, historgram=T)
```

## Data
```{r Histogram Murder, echo=FALSE, results='asis',warning=FALSE, message=FALSE}
source("Analysis/Graphs.R")
plot(histMurder) 
```

## Models

## Results
```{r plotOLSMurder, echo=FALSE, results='asis', warning=FALSE, message=FALSE}
source("Analysis/DataAnalysis.R")

stargazer(OLSMurderFoundations, OLSMurderFlow, OLSMurderTurnout, 
          type = "html",
          keep = c("FoundationsDensity100k", "FlowRate", "TurnoutPercentage"),
          header = FALSE, # important not to have stargazer information in markdown file 
          title = "Regression analysis regarding murder and three independent variable with OLS regression (controls suppressed)",
          digits = 2,
#          no.space = TRUE, # single.row = TRUE
          omit.stat = c("f", "ser"))
```

## Results

```{r plotNegbinMurder, echo=FALSE, results='asis', warning=FALSE, message=FALSE}

source("Analysis/DataAnalysis.R")

stargazer(nb.glm4, 
          type = "html",
          keep = c("FoundationsDensity100k", "FlowRate", "TurnoutPercentage"),
          header = FALSE, # important not to have stargazer information in markdown file 
          title = "Regression analysis regarding murder and three independent variable with negative binominal regression (controls suppressed)",
          digits = 2,
#          no.space = TRUE, # single.row = TRUE
          omit.stat = c("f", "ser"))
```

## Results
```{r plotPoissonMurder, echo=FALSE, results='asis', warning=FALSE, message=FALSE}

source("Analysis/DataAnalysis.R")

stargazer(poisson.glm4,
          type = "html",
          keep = c("FoundationsDensity100k", "FlowRate", "TurnoutPercentage"),
          header = FALSE, # important not to have stargazer information in markdown file 
          title = "Regression analysis regarding murder and three independent variable with Poisson regression (controls suppressed)",
          digits = 2,
#          no.space = TRUE, # single.row = TRUE
          omit.stat = c("f", "ser"))
```

## MC Simulation
```{r MC Sim NB, echo=FALSE, results='asis', warning=FALSE, message=FALSE}
source("Analysis/DataAnalysis.R")
plot(snb.out)
```

## <!-- last slide-->
<br><br><br><br><br><br>
<center><b>Thank you for your attention!<br>
Any questions?</b></center>
